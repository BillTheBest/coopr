<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-55081520-3']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Server Configuration &mdash; Coopr 0.9.9 Documentation</title>
    
    <link rel="stylesheet" href="../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Coopr 0.9.9 Documentation" href="../index.html" />
    <link rel="up" title="Installation Guide" href="index.html" />
    <link rel="next" title="Provisioner Configuration" href="provisioner-config.html" />
    <link rel="prev" title="Coopr Installation" href="packages.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="provisioner-config.html" title="Provisioner Configuration"
             accesskey="N">Next</a> |</li>
        <li class="right" >
          <a href="packages.html" title="Coopr Installation"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/coopr/json-versions.js"/></script>
        <script>window.setVersion('0.9.9');</script>
       
        <li><a href="../index.html">Coopr Documentation v0.9.9</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Installation Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="server-configuration">
<span id="index-0"></span><h1>Server Configuration<a class="headerlink" href="#server-configuration" title="Permalink to this headline">¶</a></h1>
<p>Coopr Server uses Zookeeper for task coordination and a database for persistent data. The
server will work out of the box without any configuration options using an in-process
Zookeeper and an embedded Derby DB; however, we strongly recommend that administrators
supply their own Zookeeper quorum and database outside of Coopr for performance and
maintainability. Below, we indicate how you can supply your own database (in this example,
a MySQL server) for storage with an associated JDBC connector in the server configuration
file.</p>
<p>The Coopr Server needs to be restarted after any configuration changes are made, as they
are not automatically reread.</p>
<div class="section" id="zookeeper">
<h2>Zookeeper<a class="headerlink" href="#zookeeper" title="Permalink to this headline">¶</a></h2>
<p>The zookeeper quorum, a collection of nodes running instances of Zookeeper, is specified
as a comma-delimited list of <tt class="docutils literal"><span class="pre">&lt;host&gt;:&lt;port&gt;</span></tt>:</p>
<div class="highlight-xml"><div class="highlight"><pre>server1:2181,server2:2181,server3:2181
</pre></div>
</div>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>Coopr uses JDBC for database access. To provide your own database, and for Coopr to access
it, you must specify a driver, a connection string, a user, and a password, as shown in
the following example.  We also recommend specifying a validation query to be used with
jdbc connection pooling.  The query will change based on which database you are using.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="cp">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.host<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>127.0.0.1<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>Specifies the hostname/IP address for the server to bind to<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.zookeeper.quorum<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>127.0.0.1:2181<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>Specifies the zookeeper host:port<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.jdbc.driver<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>com.mysql.jdbc.Driver<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>Specifies DB driver<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.jdbc.connection.string<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>jdbc:mysql://127.0.0.1:3306/coopr?useLegacyDatetimeCode=false<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>Specifies DB connection string<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.db.user<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>coopr<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>DB user<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.db.password<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>cooprers<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>DB user password<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.jdbc.validation.query<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>SELECT 1<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>Query used with connection pools to validate a JDBC connection taken from a pool<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="plugin-resource-store">
<h2>Plugin Resource Store<a class="headerlink" href="#plugin-resource-store" title="Permalink to this headline">¶</a></h2>
<p>By default, the server stores plugin resources on the local file system. If you are running multiple servers for
HA, you must either configure the server to write the resources to some shared filesystem like NFS, or you must
supply your own distributed file store. To set the location that plugin resources are written to, add the following
setting to your config.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.plugin.store.localfilestore.data.dir<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>/shared/path<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>base path where plugin resources will be written to<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
<p>If you are using an alternate distributed file store, you must provide a class that implements the <tt class="docutils literal"><span class="pre">PluginStore</span></tt> interface.
See the <a class="reference internal" href="../javadocs/index.html"><em>javadocs</em></a> for more information about the interface. Once you have implemented the interface,
you must build a jar and include it in the lib directory for the server, and edit the following config setting in your config.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.plugin.store.class<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>fully qualified cla/shared/path<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>fully qualified class name that implements your plugin store<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
<p>For more details about plugin resources, see the <a class="reference internal" href="../guide/admin/plugin-resources.html"><em>Plugin Resources Guide</em></a>.</p>
</div>
<div class="section" id="callbacks">
<h2>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h2>
<p>The Server can be configured to run callbacks before any cluster operation begins, after an
operation succeeds, and after an operation fails. By default, no callbacks are run. Out of the
box, the Server supports sending an HTTP POST request containing cluster and job information to
configurable endpoints. You can also write your own custom callback and plug it in.
See <a class="reference internal" href="../guide/superadmin/callbacks.html"><em>Cluster Callbacks</em></a> for information on how to write your own custom callbacks.</p>
<p>To enable HTTP POST callbacks you must specify a url to send the request to.  There is a configuration
setting for the url to use on start, success, and failure of a cluster operation. If a url is not given,
no request will be sent. By default, a request will be for every type of cluster operation, but the Server
can be configured to only send the request for certain types of cluster operations by providing a comma
separated list of operations in the configuration. An example of configuration settings is shown below.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="cp">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.callback.http.start.url<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>http://host:port/start/path<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>URL to send POST request to at the start of a cluster operation<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.callback.http.start.triggers<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>cluster_create,restart_services,stop_services,cluster_configure_with_restart<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>Comma separated list of cluster operations that will trigger the HTTP POST call<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.callback.http.failure.url<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>http://host:port/failure/path<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>URL to send POST request to if a cluster operation fails<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>server.callback.http.failure.triggers<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>cluster_create<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;description&gt;</span>Comma separated list of cluster operations that will trigger the HTTP POST call<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
<p>With the configuration above, a HTTP Post request will be sent to
<tt class="docutils literal"><span class="pre">http://host:port/start/path</span></tt> before the start of every <tt class="docutils literal"><span class="pre">CLUSTER_CREATE</span></tt>,
<tt class="docutils literal"><span class="pre">RESTART_SERVICES</span></tt>, <tt class="docutils literal"><span class="pre">STOP_SERVICES</span></tt>, and <tt class="docutils literal"><span class="pre">CLUSTER_CONFIGURE_WITH_RESTART</span></tt> operation.
If no triggers are given, the request is sent before the start of every cluster operation.
Similarly, a HTTP POST request will be sent to <a class="reference external" href="http://host:port/failure/path">http://host:port/failure/path</a> if a
<tt class="docutils literal"><span class="pre">CLUSTER_CREATE</span></tt> operation fails. Since no success url is given, no request is sent when
cluster operations complete successfully. The full list of cluster operations are:</p>
<div class="highlight-xml"><div class="highlight"><pre>CLUSTER_CREATE
CLUSTER_DELETE
CLUSTER_CONFIGURE
CLUSTER_CONFIGURE_WITH_RESTART
STOP_SERVICES
START_SERVICES
RESTART_SERVICES
ADD_SERVICES
</pre></div>
</div>
</div>
<div class="section" id="running-a-server-with-ssl">
<h2>Running a Server with SSL<a class="headerlink" href="#running-a-server-with-ssl" title="Permalink to this headline">¶</a></h2>
<p>SSL configuration requires these steps: (the first two steps are only necessary once per machine)</p>
<ul class="simple">
<li>Create a java keystore, keeping track of the keystore password and keystore key password</li>
<li>Put the keystore in place (e.g. in /etc/pki/java/serverkeystore.jks as in the example configuration below)</li>
<li>Correctly configure the UI (next step)</li>
</ul>
<div class="section" id="ssl-configuration">
<h3>SSL Configuration<a class="headerlink" href="#ssl-configuration" title="Permalink to this headline">¶</a></h3>
<p>To enable running a server with SSL, add this property to <tt class="docutils literal"><span class="pre">coopr-site.xml</span></tt> (while the
configuration file path is set in <tt class="docutils literal"><span class="pre">/etc/alternatives/...</span></tt>, the default directory is
<tt class="docutils literal"><span class="pre">/etc/coopr/conf</span></tt> and the configuration files are typically located there):</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.ssl.enabled<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>true<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Whether or not to run the server over SSL<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
<p>Set the following properties in <tt class="docutils literal"><span class="pre">coopr-site.xml</span></tt> for the keystore paths:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- Keystore path for external API SSL (server.ssl.enabled) --&gt;</span>
<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.ssl.keystore.path<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>/etc/pki/java/serverkeystore.jks<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Keystore file location<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>

<span class="c">&lt;!-- Keystore path for internal API SSL (server.tasks.ssl.enabled) --&gt;</span>
<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.tasks.ssl.keystore.path<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>/etc/pki/java/serverkeystore.jks<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Tasks Keystore file location<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
<p>Modify the values shown above to reflect the paths of your relevant keystores.</p>
<p>Add these properties to <tt class="docutils literal"><span class="pre">coopr-security.xml</span></tt>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- keystore info for external API SSL (server.ssl.enabled) --&gt;</span>
<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.ssl.keystore.password<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>Keystore password<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Keystore password<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.ssl.cert.password<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>Keystore key password<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Keystore key password<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>

<span class="c">&lt;!-- keystore info for internal API SSL (server.tasks.ssl.enabled) --&gt;</span>
<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.tasks.ssl.keystore.password<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>Keystore password<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Keystore password<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
  <span class="nt">&lt;name&gt;</span>server.tasks.ssl.cert.password<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;value&gt;</span>Keystore key password<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;description&gt;</span>Keystore key password<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>
<p class="rubric">SSL Notes</p>
<ul class="simple">
<li>The keystore needs to be created before configuring SSL in Coopr. The keystore&#8217;s passwords
and information should be gathered accordingly, in preparation for that.</li>
<li>The keystore path (<tt class="docutils literal"><span class="pre">server.ssl.keystore.path</span></tt>) is not a directory, but rather the full
path of the keystore file itself, such as <tt class="docutils literal"><span class="pre">/etc/pki/java/mykeystore</span></tt>.</li>
<li>For the keystore configuration, update the <em>Keystore path</em> and replace <em>Keystore password</em>
and <em>Keystore key password</em> with the actual file path of the keystore, the keystore
password and the key password respectively that were used in generating the keystore.</li>
</ul>
</div>
</div>
<div class="section" id="id1">
<h2>Server Configuration<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>An alphabetical list of the available configuration settings and their default values:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="30%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Config setting</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.class</span></tt></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">co.cask.coopr.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">scheduler.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">HttpPostClusterCallback</span></tt></div>
</div>
</td>
<td>Class to use for executing cluster callbacks</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.failure.triggers</span></tt></div>
</div>
</td>
<td>all operations</td>
<td>Comma-separated list of cluster operations that should trigger an HTTP POST request
to be sent after the operation fails</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.failure.url</span></tt></div>
</div>
</td>
<td>&nbsp;</td>
<td>If <tt class="docutils literal"><span class="pre">HttpPostClusterCallback</span></tt> is in use, URL to send cluster and job information
to after cluster operations fail; leave unset if no request should be sent</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.max.connections</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">100</span></tt></td>
<td>Maximum number of concurrent http connections for callbacks; if the max is reached, the
next callback to try and send a request blocks until an open connection frees up</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.socket.timeout</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">10000</span></tt></td>
<td>Socket timeout in milliseconds for HTTP callbacks</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.start.triggers</span></tt></div>
</div>
</td>
<td>all operations</td>
<td>Comma-separated list of cluster operations that should trigger an HTTP POST request
to be sent before start of the operation</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.start.url</span></tt></div>
</div>
</td>
<td>&nbsp;</td>
<td>If <tt class="docutils literal"><span class="pre">HttpPostClusterCallback</span></tt> is in use, URL to send cluster and job information
to before cluster operations start; leave unset if no request should be sent</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.success.triggers</span></tt></div>
</div>
</td>
<td>all operations</td>
<td>Comma-separated list of cluster operations that should trigger an HTTP POST request
to be sent after the operation completes successfully</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.callback.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">http.success.url</span></tt></div>
</div>
</td>
<td>&nbsp;</td>
<td>If <tt class="docutils literal"><span class="pre">HttpPostClusterCallback</span></tt> is in use, URL to send cluster and job information
to after cluster operations complete successfully; leave unset if no request should
be sent</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.cluster.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">cleanup.seconds</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">180</span></tt></td>
<td>Interval, in seconds, between server housekeeping runs; housekeeping such as timing
out tasks and expiring clusters</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">server.db.password</span></tt></td>
<td>&nbsp;</td>
<td>Database password</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">server.db.user</span></tt></td>
<td><tt class="docutils literal"><span class="pre">coopr</span></tt></td>
<td>Database user</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">server.host</span></tt></td>
<td><tt class="docutils literal"><span class="pre">localhost</span></tt></td>
<td>Hostname/IP address for the server to bind to</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.ids.increment.by</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">1</span></tt></td>
<td>Along with <tt class="docutils literal"><span class="pre">server.ids.start.num</span></tt>, this setting is used to partition the ID space
for <a class="reference internal" href="../guide/bcp/multi-data-center-bcp.html"><em>Multi-Datacenter High Availability</em></a>. The
IDs will increment by this number in a datacenter. All datacenters have to share the
same value of <tt class="docutils literal"><span class="pre">server.ids.increment.by</span></tt> to prevent overlapping of IDs. This number
has to be large enough to enable future datacenter expansion.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.ids.start.num</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">1</span></tt></td>
<td>Along with <tt class="docutils literal"><span class="pre">server.ids.increment.by</span></tt>, this setting is used to partition the ID
space for <a class="reference internal" href="../guide/bcp/multi-data-center-bcp.html"><em>Multi-Datacenter High Availability</em></a>. The ID generation in a datacenter will start
from this number. Each datacenter will need to have a different start number so that
the IDs do not overlap. All Coopr Servers in a datacenter should share the same value
of <tt class="docutils literal"><span class="pre">server.ids.start.num</span></tt>.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.jdbc.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">connection.string</span></tt></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">jdbc:derby:</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">/var/coopr/data/db/coopr;</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">create=true</span></tt></div>
</div>
</td>
<td>JDBC connection string to user for database operations</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.jdbc.driver</span></tt></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">org.apache.derby.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">jdbc.EmbeddedDriver</span></tt></div>
</div>
</td>
<td>JDBC driver to use for database operations</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.jdbc.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">max.active.connections</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">100</span></tt></td>
<td>Maximum active JDBC connections</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.jdbc.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">validation.query</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">&quot;VALUES</span> <span class="pre">1&quot;</span></tt> when using default for <tt class="docutils literal"><span class="pre">server.jdbc.driver</span></tt> (Derby); <tt class="docutils literal"><span class="pre">&quot;null&quot;</span></tt> otherwise</td>
<td>Validation query used by JDBC connection pool to validate new DB connections;
MySQL, PostgreSQL, and Microsoft SQL Server can use <tt class="docutils literal"><span class="pre">&quot;select</span> <span class="pre">1&quot;</span></tt>; Oracle can use
<tt class="docutils literal"><span class="pre">&quot;select</span> <span class="pre">1</span> <span class="pre">from</span> <span class="pre">dual&quot;</span></tt></td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.local.data.dir</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">/var/coopr/data</span></tt></td>
<td>Local data directory that default in-memory Zookeeper and embedded Derby will use</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.metrics.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">queue.cache.seconds</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">10</span></tt></td>
<td>Seconds to cache queue metrics in memory before recalculating; queue metrics
require walking through the queue and are therefore expensive to compute</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.netty.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">exec.num.threads</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">50</span></tt></td>
<td>Number of execution threads for the server</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.netty.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">worker.num.threads</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">20</span></tt></td>
<td>Number of worker threads for the server</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.node.max.log.length</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">2048</span></tt></td>
<td>Maximum log size in bytes for capturing stdout and stderr for actions performed on
cluster nodes; logs longer than set limit will be trimmed from the head of the file</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.node.max.num.actions</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">200</span></tt></td>
<td>Maximum number of actions saved for a node; oldest action will be removed when
actions exceeding this limit are performed on a node</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.max.action.retries</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">3</span></tt></td>
<td>Maximum number of times a task gets retried when it fails</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.max.cluster.size</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">10000</span></tt></td>
<td>Maximum number of nodes that a given cluster can be created with</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.plugin.store.class</span></tt></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">co.cask.coopr.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">store.provisioner.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">LocalFilePluginStore</span></tt></div>
</div>
</td>
<td>Class to use to store plugin resources</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.plugin.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">store.localfilestore.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">data.dir</span></tt></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">/var/coopr/data/</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">plugins/resources</span></tt></div>
</div>
</td>
<td>Data directory to store plugin resources when using the local file plugin store</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">server.port</span></tt></td>
<td><tt class="docutils literal"><span class="pre">55054</span></tt></td>
<td>Port for the server</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.provisioner.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">request.max.retries</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">2</span></tt></td>
<td>Maximum number of times to retry a failed request to a provisioner before reassigning
its workers and deleting it</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.provisioner.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">request.ms.between.retries</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">500</span></tt></td>
<td>Milliseconds to wait before retrying a failed request to a provisioner</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.provisioner.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">request.socket.timeout.ms</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">10000</span></tt></td>
<td>Socket timeout in milliseconds to use when making requests to provisioners</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.provisioner.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">timeout.check.interval.secs</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">60</span></tt></td>
<td>Seconds between checks for timed out provisioners</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.provisioner.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">timeout.secs</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">120</span></tt></td>
<td>Seconds to wait for a provisioner heartbeat before moving its workers and deleting it</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.scheduler.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">run.interval.seconds</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">1</span></tt></td>
<td>Interval, in seconds, various runs are scheduled on the server</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.solver.num.threads</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">20</span></tt></td>
<td>Number of threads used for solving cluster layout</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">server.ssl.enabled</span></tt></td>
<td><tt class="docutils literal"><span class="pre">false</span></tt></td>
<td>Enable running server with SSL</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.task.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">timeout.seconds</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">1800</span></tt></td>
<td>Number of seconds the server will wait before timing out a provisioner task and marking it as failed</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.zookeeper.namespace</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">/coopr</span></tt></td>
<td>Namespace to use in Zookeeper</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.zookeeper.</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">session.timeout.millis</span></tt></div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">40000</span></tt></td>
<td>Zookeeper session timeout value in milliseconds</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">server.zookeeper.quorum</span></tt></div>
</div>
</td>
<td>A local value determined by an in-memory Zookeeper</td>
<td>Zookeeper quorum for the server</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><!--
  Copyright © 2014-2015 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


    
<div aria-label="globaltoc links">
<h3 class="pagenavtitle"><a href="../index.html"> Table&nbsp;of&nbsp;Contents</a></h3>
<nav class="pagenav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/quickstart/index.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/architecture.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Installation Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="packages.html">Coopr Installation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Server Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#zookeeper">Zookeeper</a></li>
<li class="toctree-l3"><a class="reference internal" href="#database">Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plugin-resource-store">Plugin Resource Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="#callbacks">Callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-a-server-with-ssl">Running a Server with SSL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ssl-configuration">SSL Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Server Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="provisioner-config.html">Provisioner Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="standalone.html">Coopr Sandboxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="openstack-config.html">Openstack Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="ui-config.html">UI Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html">Authentication Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html">Coopr Upgrade</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide/superadmin/index.html">Super Admin Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/admin/index.html">Administration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rest/index.html">Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementation.html">Under the Hood</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javadocs/index.html">Javadocs</a></li>
</ul>

</nav>
</div>
  <h4>Previous Topic</h4>
  <p class="topless"><a href="packages.html"
                        title="Previous Chapter">Coopr Installation</a></p>
  <h4>Next Topic</h4>
  <p class="topless"><a href="provisioner-config.html"
                        title="Next Chapter">Provisioner Configuration</a></p>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/coopr/0.9.9/coopr-docs-0.9.9-web.zip"
            rel="nofollow">Zip Archive of Coopr Documentation</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="Coopr Installation" href="packages.html" />Coopr Installation</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        Copyright &copy; 2014-2015 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">&nbsp;&nbsp;Next Topic:
    <a title="Provisioner Configuration" href="provisioner-config.html" />Provisioner Configuration</a>
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-27787617-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Server Configuration &mdash; Loom 0.9.5 Beta documentation</title>
    
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9.5 Beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Loom 0.9.5 Beta documentation" href="../../index.html" />
    <link rel="up" title="Administration Guide" href="index.html" />
    <link rel="next" title="Administration User Interface" href="ui.html" />
    <link rel="prev" title="Installation Guide" href="../installation/index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ui.html" title="Administration User Interface"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../installation/index.html" title="Installation Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Loom 0.9.5 Beta documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Administration Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="server-configuration">
<h1>Server Configuration<a class="headerlink" href="#server-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="configuring-the-server">
<h2>Configuring the server<a class="headerlink" href="#configuring-the-server" title="Permalink to this headline">¶</a></h2>
<p>Loom server uses Zookeeper for task coordination and a database for persistent data. The server will work out of the box
without any configuration options with an in memory Zookeeper and an embedded Derby DB; however, we
strongly recommend that administrators supply their own Zookeeper quorum and database outside of Loom for performance and
maintainability. Below we indicate how you can supply your own database (in this case MySQL server) for storage,
and the associated JDBC connector in the server configuration file.</p>
<div class="section" id="zookeeper">
<h3>Zookeeper<a class="headerlink" href="#zookeeper" title="Permalink to this headline">¶</a></h3>
<p>The zookeeper quorum, a collection of nodes running instances of Zookeeper, is specified as a comma delimited list of <tt class="docutils literal"><span class="pre">&lt;host&gt;:&lt;port&gt;</span></tt> (e.g. <tt class="docutils literal"><span class="pre">server1:2181,server2:2181,server3:2181</span></tt>).</p>
</div>
<div class="section" id="database">
<h3>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h3>
<p>Loom uses JDBC for database access. To provide your own database, and for Loom to access it, you must specify a driver, a connection string,
a user, and a password, as shown in the following example.  We also recommend specifying a validation query to be used with jdbc connection
pooling.  The query will change based on which database you are using.</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;
&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;loom.host&lt;/name&gt;
    &lt;value&gt;127.0.0.1&lt;/value&gt;
    &lt;description&gt;Specifies the hostname/IP address for the server to bind to&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;zookeeper.quorum&lt;/name&gt;
    &lt;value&gt;127.0.0.1:2181&lt;/value&gt;
    &lt;description&gt;Specifies the zookeeper host:port&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;loom.jdbc.driver&lt;/name&gt;
    &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
    &lt;description&gt;Specifies DB driver&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;loom.jdbc.connection.string&lt;/name&gt;
    &lt;value&gt;jdbc:mysql://127.0.0.1:3306/loom?useLegacyDatetimeCode=false&lt;/value&gt;
    &lt;description&gt;Specifies DB connection string&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;loom.db.user&lt;/name&gt;
    &lt;value&gt;loom&lt;/value&gt;
    &lt;description&gt;DB user&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;loom.db.password&lt;/name&gt;
    &lt;value&gt;loomers&lt;/value&gt;
    &lt;description&gt;DB user password&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;loom.jdbc.validation.query&lt;/name&gt;
    &lt;value&gt;SELECT 1&lt;/value&gt;
    &lt;description&gt;query used with connection pools to validate a jdbc connection taken from a pool&lt;/description&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>A full list of available configuration settings and their default values are given below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Config setting</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zookeeper.quorum</td>
<td>A local value determined by an in-memory Zookeeper.</td>
<td>Zookeeper quorum for the server.</td>
</tr>
<tr class="row-odd"><td>zookeeper.namespace</td>
<td>&#8220;/loom&#8221;</td>
<td>Namespace to use in Zookeeper</td>
</tr>
<tr class="row-even"><td>zookeeper.session.timeout.millis</td>
<td>40000</td>
<td>Zookeeper session timeout value in milliseconds.</td>
</tr>
<tr class="row-odd"><td>loom.port</td>
<td>55054</td>
<td>Port for the server.</td>
</tr>
<tr class="row-even"><td>loom.host</td>
<td>&#8220;localhost&#8221;</td>
<td>Hostname/IP address for the server to bind to.</td>
</tr>
<tr class="row-odd"><td>loom.jdbc.driver</td>
<td>org.apache.derby.jdbc.EmbeddedDriver</td>
<td>JDBC driver to use for database operations.</td>
</tr>
<tr class="row-even"><td>loom.jdbc.connection.string</td>
<td>&#8220;<a class="reference external" href="jdbc:derby:/var/loom/data/db/loom;create=true">jdbc:derby:/var/loom/data/db/loom;create=true</a>&#8220;</td>
<td>JDBC connection string to user for database operations.</td>
</tr>
<tr class="row-odd"><td>loom.jdbc.validation.query</td>
<td>&#8220;VALUES 1&#8221; when using default for loom.jdbc.driver (Derby), null otherwise.</td>
<td>Validation query used by JDBC connection pool to validate new DB connections.  mysql, postgres, and microsoft sql server can use &#8220;select 1&#8221;.  oracle can use &#8220;select 1 from dual&#8221;.</td>
</tr>
<tr class="row-even"><td>loom.jdbc.max.active.connections</td>
<td>100</td>
<td>Maximum active JDBC connections.</td>
</tr>
<tr class="row-odd"><td>loom.db.user</td>
<td>&#8220;loom&#8221;</td>
<td>Database user.</td>
</tr>
<tr class="row-even"><td>loom.db.password</td>
<td>null</td>
<td>Database password.</td>
</tr>
<tr class="row-odd"><td>loom.solver.num.threads</td>
<td>20</td>
<td>Number of threads used for solving cluster layout.</td>
</tr>
<tr class="row-even"><td>loom.local.data.dir</td>
<td>&#8220;/var/loom/data&#8221;</td>
<td>Local data directory that default in-memory Zookeeper and embedded Derby will use.</td>
</tr>
<tr class="row-odd"><td>loom.task.timeout.seconds</td>
<td>1800</td>
<td>Number of seconds the server will wait before timing out a provisioner task and marking it as failed.</td>
</tr>
<tr class="row-even"><td>loom.cluster.cleanup.seconds</td>
<td>180</td>
<td>Interval, in seconds, between server housekeeping runs. Housekeeping includes timing out tasks, expiring clusters, etc.</td>
</tr>
<tr class="row-odd"><td>loom.netty.exec.num.threads</td>
<td>50</td>
<td>Number of execution threads for the server.</td>
</tr>
<tr class="row-even"><td>loom.netty.worker.num.threads</td>
<td>20</td>
<td>Number of worker threads for the server.</td>
</tr>
<tr class="row-odd"><td>loom.node.max.log.length</td>
<td>2048</td>
<td>Maximum log size in bytes for capturing stdout and stderr for actions performed on cluster nodes. Logs longer than set limit will be trimmed from the head of the file.</td>
</tr>
<tr class="row-even"><td>loom.node.max.num.actions</td>
<td>200</td>
<td>Maximum number of actions saved for a node. Oldest action will be removed when actions exceeding this limit are performed on a node.</td>
</tr>
<tr class="row-odd"><td>loom.max.cluster.size</td>
<td>10000</td>
<td>Maximum number of nodes that a given cluster can be created with.</td>
</tr>
<tr class="row-even"><td>loom.max.action.retries</td>
<td>3</td>
<td>Maximum number of times a task gets retried when it fails.</td>
</tr>
<tr class="row-odd"><td>scheduler.run.interval.seconds</td>
<td>1</td>
<td>Interval, in seconds, various runs are scheduled on the server.</td>
</tr>
<tr class="row-even"><td>loom.ids.start.num</td>
<td>1</td>
<td>Along with <tt class="docutils literal"><span class="pre">loom.ids.increment.by</span></tt>, this setting is used to partition the ID space for <a class="reference internal" href="../bcp/multi-data-center-bcp.html"><em>Multi-Datacenter High Availability</em></a>. The ID generation in a datacenter will start from this number. Each datacenter will need to have a different start number so that the IDs do not overlap. All Loom Servers in a datacenter should share the same value of <tt class="docutils literal"><span class="pre">loom.ids.start.num</span></tt>.</td>
</tr>
<tr class="row-odd"><td>loom.ids.increment.by</td>
<td>1</td>
<td>Along with <tt class="docutils literal"><span class="pre">loom.ids.start.num</span></tt>, this setting is used to partition the ID space for <a class="reference internal" href="../bcp/multi-data-center-bcp.html"><em>Multi-Datacenter High Availability</em></a>. The IDs will increment by this number in a datacenter. All datacenters have to share the same value of <tt class="docutils literal"><span class="pre">loom.ids.increment.by</span></tt> to prevent overlapping of IDs. This number has to be large enough to enable future datacenter expansion.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/architecture.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Administration Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/index.html">Installation Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Server Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-server">Configuring the server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#zookeeper">Zookeeper</a></li>
<li class="toctree-l4"><a class="reference internal" href="#database">Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ui.html">Administration User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="macros.html">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Provisioner Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitoring.html">Monitoring and Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bcp/index.html">Business Continuity Plan (BCP)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rest/index.html">Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/glossary.html">Glossary</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../installation/index.html"
                        title="previous chapter">Installation Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ui.html"
                        title="next chapter">Administration User Interface</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ui.html" title="Administration User Interface"
             >next</a> |</li>
        <li class="right" >
          <a href="../installation/index.html" title="Installation Guide"
             >previous</a> |</li>
        <li><a href="../../index.html">Loom 0.9.5 Beta documentation</a> &raquo;</li>
          <li><a href="index.html" >Administration Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Continuuity Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>
'use strict';

describe('controller', function(){

  var providertypes = [{"description":"","resourceTypes":{"ssh_keys":{"format":"file","permissions":"0400"}},"parameters":{"admin":{"fields":{"api_password":{"label":"Secret Access Key","type":"password","tip":"AWS Secret Access Key","override":false,"sensitive":false},"api_user":{"label":"Access Key ID","type":"text","tip":"AWS Access Key ID","override":false,"sensitive":false},"associate_public_ip":{"label":"Associate public IP (VPC only)","type":"checkbox","tip":"Associate public IP (VPC only)","default":true,"override":true,"sensitive":false},"availability_zone":{"label":"Availability Zone","type":"text","tip":"AWS Availability Zone","override":true,"sensitive":false},"aws_ebs_delete_on_term":{"label":"EBS delete on termination","type":"checkbox","tip":"Delete EBS volumes on termination","default":true,"override":true,"sensitive":false},"aws_ebs_size":{"label":"EBS size","type":"text","tip":"Size of EBS volume in GB, for EBS-backed instances","default":"10","override":true,"sensitive":false},"aws_region":{"label":"AWS Region","type":"select","tip":"AWS Region","default":"us-east-1","override":false,"sensitive":false,"options":["ap-northeast-1","ap-southeast-1","ap-southeast-2","eu-west-1","sa-east-1","us-east-1","us-west-1","us-west-2"]},"dedicated_instance":{"label":"Use Dedicated instances (VPC only)","type":"checkbox","tip":"Launch as dedicated instances (VPC only)","override":true,"sensitive":false},"iam_instance_profile":{"label":"IAM instance profile","type":"text","tip":"IAM instance profile to apply to cluster","override":true,"sensitive":false},"placement_group":{"label":"Placement group","type":"text","tip":"Placement group to place cluster instances","override":true,"sensitive":false},"security_group_ids":{"label":"Security Group IDs (VPC only)","type":"text","tip":"AWS security group IDs (required for VPC)","override":true,"sensitive":false},"security_groups":{"label":"Security Groups","type":"text","tip":"AWS security group (non-VPC)","default":"default","override":true,"sensitive":false},"ssh_key_resource":{"label":"SSH Key Resource Name","type":"text","tip":"Name of the SSH private key resource uploaded to the server","override":true,"sensitive":false},"ssh_keypair":{"label":"Key Pair Name","type":"text","tip":"Your AWS EC2 key pair name","override":true,"sensitive":false},"subnet_id":{"label":"Subnet ID (VPC only)","type":"text","tip":"Enable VPC and use this subnet ID","override":true,"sensitive":false}},"required":[["api_user","api_password","ssh_keypair","ssh_key_resource","aws_region","security_groups"],["api_user","api_password","ssh_keypair","ssh_key_resource","aws_region","security_group_ids","subnet_id"]]}},"name":"aws"},{"description":"","resourceTypes":{"api_keys":{"format":"file","permissions":"0400"},"ssh_keys":{"format":"file","permissions":"0400"}},"parameters":{"admin":{"fields":{"api_key_resource":{"label":"API Key Resource Name","type":"text","tip":"Name of the P12 key resource uploaded to the server","override":false,"sensitive":false},"google_client_email":{"label":"Service account email address","type":"text","tip":"Service account email address, should be of the form 123456789@developer.gserviceaccount.com","override":false,"sensitive":false},"google_data_disk_size_gb":{"label":"Data disk size in GB","type":"text","tip":"Size of the persistent data disk to be created and mounted","default":"10","override":true,"sensitive":false},"google_project":{"label":"Project ID","type":"text","tip":"Google Project ID","override":false,"sensitive":false},"ssh_key_resource":{"label":"SSH Key Resource Name","type":"text","tip":"Name of the SSH key resource uploaded to the server","override":false,"sensitive":false},"ssh_user":{"label":"SSH Username","type":"text","tip":"SSH username. A corresponding key must be configured in the portal","override":false,"sensitive":false},"zone_name":{"label":"Zone","type":"select","tip":"Zone","default":"us-central1-a","override":true,"sensitive":false,"options":["asia-east1-a","asia-east1-b","asia-east1-c","europe-west1-a","europe-west1-b","us-central1-a","us-central1-b","us-central1-f"]}},"required":[["google_project","google_client_email","api_key_resource","ssh_key_resource","zone_name"]]},"user":{"fields":{"network":{"label":"Network","type":"text","tip":"Google custom network","override":false,"sensitive":false}},"required":[[]]}},"name":"google"},{"description":"","resourceTypes":{"ssh_keys":{"format":"file","permissions":"0400"}},"parameters":{"admin":{"fields":{"api_password":{"label":"CloudAPI Password","type":"password","tip":"Your Joyent CloudAPI password","override":false,"sensitive":false},"api_user":{"label":"CloudAPI Username","type":"text","tip":"Your Joyent CloudAPI user name","override":false,"sensitive":false},"joyent_api_url":{"label":"Region","type":"select","tip":"Joyent Region","default":"https://us-east-1.api.joyentcloud.com","override":true,"sensitive":false,"options":["https://us-east-1.api.joyentcloud.com","https://us-east-2.api.joyentcloud.com","https://us-east-3.api.joyentcloud.com","https://us-sw-1.api.joyentcloud.com","https://us-west-1.api.joyentcloud.com","https://eu-ams-1.api.joyentcloud.com"]},"joyent_version":{"label":"API version","type":"text","tip":"CloudAPI version (~7.0 default)","default":"~7.0","override":false,"sensitive":false},"ssh_key_resource":{"label":"SSH Key Resource Name","type":"text","tip":"Name of the SSH private key resource uploaded to the server","override":false,"sensitive":false},"ssh_keypair":{"label":"Key Name","type":"text","tip":"Your Joyent SSH Key Name","override":false,"sensitive":false}},"required":[["api_user","api_password"],["api_user","ssh_keypair","ssh_key_resource"]]}},"name":"joyent"},{"description":"","resourceTypes":{"ssh_keys":{"format":"file","permissions":"0400"}},"parameters":{"admin":{"fields":{"api_password":{"label":"Password","type":"password","tip":"Your Openstack password","override":false,"sensitive":false},"api_user":{"label":"Username","type":"text","tip":"Your Openstack user name","override":false,"sensitive":false},"openstack_auth_url":{"label":"Auth URL","type":"text","tip":"Your Openstack Keystone API URL","default":"http://EXAMPLE.DOMAIN.COM:5000/v2.0/tokens","override":false,"sensitive":false},"openstack_ssl_verify_peer":{"label":"Verify SSL peers","type":"checkbox","tip":"Verify peer SSL certificates","override":false,"sensitive":false},"openstack_tenant":{"label":"Tenant","type":"text","tip":"Your Openstack tenant","override":false,"sensitive":false},"ssh_key_resource":{"label":"SSH Key Resource Name","type":"text","tip":"Name of the SSH private key resource uploaded to the server","override":false,"sensitive":false},"ssh_keypair":{"label":"Key name","type":"text","tip":"Your Openstack SSH public key name","override":false,"sensitive":false}},"required":[["api_user","api_password","openstack_tenant","openstack_auth_url","ssh_keypair","ssh_key_resource"]]},"user":{"fields":{"availability_zone":{"label":"Availability Zone","type":"text","tip":"Openstack Availability Zone","override":false,"sensitive":false},"floating_ip":{"label":"Floating IP","type":"checkbox","tip":"Request a floating IP address for each node","override":false,"sensitive":false},"security_groups":{"label":"Security Group","type":"text","tip":"Openstack security groups (comma separated)","default":"default","override":false,"sensitive":false}},"required":[[]]}},"name":"openstack"},{"description":"","resourceTypes":{"ssh_keys":{"format":"file","permissions":"0400"}},"parameters":{"admin":{"fields":{"api_password":{"label":"API key","type":"password","tip":"Your Rackspace API key","override":false,"sensitive":false},"api_user":{"label":"Username","type":"text","tip":"Your Rackspace user name","override":false,"sensitive":false},"rackspace_region":{"label":"Region","type":"select","tip":"Rackspace region","default":"dfw","override":true,"sensitive":false,"options":["dfw","ord","iad","lon","syd","hkg"]}},"required":[["api_user","api_password","rackspace_region"]]},"user":{"fields":{"rackconnect_wait":{"label":"RackConnect Wait","type":"checkbox","tip":"Wait for RackConnect","override":false,"sensitive":false},"ssh_key_resource":{"label":"SSH Key Resource Name","type":"text","tip":"Name of the SSH private key resource uploaded to the server","override":false,"sensitive":false},"ssh_keypair":{"label":"Key Name","type":"text","tip":"Your Rackspace SSH key name","override":false,"sensitive":false}},"required":[[]]}},"name":"rackspace"}];

  var providers = [{"name":"aws-us-east-1","description":"Amazon Web Services - US East 1 region","providertype":"aws","provisioner":{"security_group_ids":"","aws_ebs_size":"","availability_zone":"","associate_public_ip":"","aws_region":"us-east-1","aws_ebs_delete_on_term":"","security_groups":"","iam_instance_profile":"","placement_group":"","subnet_id":"","api_user":"","api_password":"","dedicated_instance":"","ssh_keypair":"","ssh_key_resource":""}},{"name":"aws-us-west-1","description":"Amazon Web Services - US West 1 region","providertype":"aws","provisioner":{"security_group_ids":"","aws_ebs_size":"","availability_zone":"","associate_public_ip":"","aws_region":"us-west-1","aws_ebs_delete_on_term":"","security_groups":"","iam_instance_profile":"","placement_group":"","subnet_id":"","api_user":"","api_password":"","dedicated_instance":"","ssh_keypair":"","ssh_key_resource":""}},{"name":"aws-us-west-2","description":"Amazon Web Services - US West 2 region","providertype":"aws","provisioner":{"security_group_ids":"","aws_ebs_size":"","availability_zone":"","associate_public_ip":"","aws_region":"us-west-2","aws_ebs_delete_on_term":"","security_groups":"","iam_instance_profile":"","placement_group":"","subnet_id":"","api_user":"","api_password":"","dedicated_instance":"","ssh_keypair":"","ssh_key_resource":""}},{"name":"google","description":"Google Compute Engine","providertype":"google","provisioner":{"google_client_email":"","zone_name":"us-central1-a","google_project":"","google_data_disk_size_gb":"","api_key_resource":"","ssh_user":"","ssh_key_resource":""}},{"name":"joyent","description":"Joyent Compute Service","providertype":"joyent","provisioner":{"api_user":"USERNAME","joyent_api_url":"https://us-sw-1.api.joyentcloud.com/","ssh_keypair":"","joyent_version":"~7.0","ssh_key_resource":""}},{"name":"openstack","description":"Openstack Private Cloud","providertype":"openstack","provisioner":{"openstack_tenant":"TENANT","api_user":"USERNAME","api_password":"PASSWORD","openstack_auth_url":"http://NAME.DOMAIN.COM:5000/v2.0/tokens","ssh_keypair":"TENANT_KEY","ssh_key_resource":""}},{"name":"rackspace","description":"Rackspace Public Cloud","providertype":"rackspace","provisioner":{"api_user":"USERNAME","api_password":"API_KEY","rackspace_region":"dfw"}}];

  beforeEach(module('coopr-ngui.controllers'));


  it('test env is ready', function() {
    expect(jasmine).toBeDefined();
    expect(angular).toBeDefined();
    expect(module).toBe(angular.mock.module);
    expect(inject).toBe(angular.mock.inject);
  });


  describe('ProviderFormCtrl', function() {
    var scope, ctrl, myApi;

    beforeEach(inject(function($rootScope, $controller, _myApi_, _$httpBackend_) {
      scope = $rootScope.$new();
      myApi = _myApi_;
      ctrl = $controller('ProviderFormCtrl', { $scope: scope });
    }));

    it('should select the correct provider', function () {
      console.log(scope.providerTypes);
      scope.model.providertype = 'aws';
      console.log(scope.model.providertype);
      scope.$digest();
      console.log(scope.selectedProvider);
    });


    it('model is a *modelName* instance', function() {
      expect(scope.model).toEqual(jasmine.any(myApi.Provider));
    });

  });

});